

<!DOCTYPE html>
<html lang="zh-TW" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/images/logo.png">
  <link rel="icon" href="/images/logo.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Simon Lai">
  <meta name="keywords" content="">
  
    <meta name="description" content="這是來自卡內基梅隆大學的優質課程，對底層系統的理解越深，對程式設計師來說只有百利而無一害。雖然一時半刻看不到有什麼成效，但未來的某些日子一定會覺得當初學了這些真是太好了  電腦名詞譯名 首先從hello world開始以C語言來說，讓寫好的以下程式碼執行，需要經過如下步驟 #include &lt;stdio.h&gt;  int main() &#123;   printf(&quot;hello, worl">
<meta property="og:type" content="article">
<meta property="og:title" content="CS:APP 電腦系統:程式設計師的角度 第一章筆記">
<meta property="og:url" content="https://f88083.github.io/2024/02/14/CS-APP-%E9%9B%BB%E8%85%A6%E7%B3%BB%E7%B5%B1-%E7%A8%8B%E5%BC%8F%E8%A8%AD%E8%A8%88%E5%B8%AB%E7%9A%84%E8%A7%92%E5%BA%A6-%E7%AC%AC%E4%B8%80%E7%AB%A0%E7%AD%86%E8%A8%98/index.html">
<meta property="og:site_name" content="Simon Lai&#39;s Blog">
<meta property="og:description" content="這是來自卡內基梅隆大學的優質課程，對底層系統的理解越深，對程式設計師來說只有百利而無一害。雖然一時半刻看不到有什麼成效，但未來的某些日子一定會覺得當初學了這些真是太好了  電腦名詞譯名 首先從hello world開始以C語言來說，讓寫好的以下程式碼執行，需要經過如下步驟 #include &lt;stdio.h&gt;  int main() &#123;   printf(&quot;hello, worl">
<meta property="og:locale" content="zh_TW">
<meta property="og:image" content="https://i.imgur.com/NvCIDhr.png">
<meta property="og:image" content="https://i.imgur.com/yVD8ZhC.png">
<meta property="og:image" content="https://i.imgur.com/babLCHf.png">
<meta property="og:image" content="https://i.imgur.com/rKgt0aw.png">
<meta property="og:image" content="https://i.imgur.com/pMAzv3D.png">
<meta property="og:image" content="https://i.imgur.com/9e2CmFR.png">
<meta property="og:image" content="https://i.imgur.com/3lW2nVT.png">
<meta property="og:image" content="https://i.imgur.com/hKpWFea.png">
<meta property="og:image" content="https://i.imgur.com/oE43if2.png">
<meta property="og:image" content="https://i.imgur.com/snODUPB.png">
<meta property="og:image" content="https://i.imgur.com/oH67rXi.png">
<meta property="og:image" content="https://i.imgur.com/kGRdWIT.png">
<meta property="og:image" content="https://i.imgur.com/p7OSF2D.png">
<meta property="og:image" content="https://i.imgur.com/NFpERa3.png">
<meta property="og:image" content="https://i.imgur.com/AccvZwZ.png">
<meta property="article:published_time" content="2024-02-14T04:17:12.000Z">
<meta property="article:modified_time" content="2024-05-29T16:47:04.964Z">
<meta property="article:author" content="Simon Lai">
<meta property="article:tag" content="Computer System">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://i.imgur.com/NvCIDhr.png">
  
  
  
  <title>CS:APP 電腦系統:程式設計師的角度 第一章筆記 - Simon Lai&#39;s Blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"f88083.github.io","root":"/","version":"1.9.7","typing":{"enable":true,"typeSpeed":35,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":"G-HJLTHPCQMP"},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  
    <!-- Google tag (gtag.js) -->
    <script async>
      if (!Fluid.ctx.dnt) {
        Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=G-HJLTHPCQMP", function() {
          window.dataLayer = window.dataLayer || [];
          function gtag() {
            dataLayer.push(arguments);
          }
          gtag('js', new Date());
          gtag('config', 'G-HJLTHPCQMP');
        });
      }
    </script>
  

  

  

  

  



  
<meta name="generator" content="Hexo 7.2.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Simon Lai&#39;s Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首頁</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>歸檔</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分類</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>標籤</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>關於</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/images/bg.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="CS:APP 電腦系統:程式設計師的角度 第一章筆記"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-02-14 12:17" pubdate>
          2024年2月14日 中午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          2.6k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          13 分鐘
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">CS:APP 電腦系統:程式設計師的角度 第一章筆記</h1>
            
            
              <div class="markdown-body">
                
                <blockquote>
<p>這是來自卡內基梅隆大學的優質課程，對底層系統的理解越深，對程式設計師來說只有百利而無一害。雖然一時半刻看不到有什麼成效，但未來的某些日子一定會覺得當初學了這些真是太好了</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="http://www.iicm.org.tw/term/termb_P.htm">電腦名詞譯名</a></p>
<h2 id="首先從hello-world開始"><a href="#首先從hello-world開始" class="headerlink" title="首先從hello world開始"></a>首先從<code>hello world</code>開始</h2><p>以<code>C</code>語言來說，讓寫好的以下程式碼執行，需要經過如下步驟</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"hello, world\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p><img src="https://i.imgur.com/NvCIDhr.png" srcset="/img/loading.gif" lazyload alt="The compilation system"></p>
<p>多方合作最終產生可執行的<code>program</code></p>
<h2 id="為什麼要懂編譯的運作過程"><a href="#為什麼要懂編譯的運作過程" class="headerlink" title="為什麼要懂編譯的運作過程?"></a>為什麼要懂編譯的運作過程?</h2><ul>
<li><strong>優化程式效能</strong>: 尤其是<code>C</code>語言這種的古老語言，需要懂得編譯的過程是怎麼運作的才能使我們做更好的選擇。如今<code>Java</code>以及<code>Python</code>等新的語言都有一群高手在底層做各種優化，讓寫程式的我們可以免除很多麻煩與顧慮</li>
<li><strong>理解<code>link-time errors</code></strong>: 當程式可以使用之前，需要把各個需要的<code>library link</code>起來</li>
<li><strong>避免安全漏洞</strong></li>
</ul>
<p>以上這些都會在未來的章節詳細介紹</p>
<h2 id="系統常見的硬體佈局"><a href="#系統常見的硬體佈局" class="headerlink" title="系統常見的硬體佈局"></a>系統常見的硬體佈局</h2><p><img src="https://i.imgur.com/yVD8ZhC.png" srcset="/img/loading.gif" lazyload alt="Hardware organization of a typical system"></p>
<p>先來大致看過就好，未來的章節會詳細說</p>
<h3 id="Buses-匯流排"><a href="#Buses-匯流排" class="headerlink" title="Buses (匯流排)"></a>Buses (匯流排)</h3><ul>
<li>為部件傳遞<code>bytes</code>訊息</li>
<li>通常傳遞固定大小，稱為<code>words</code></li>
<li>不同系統的<code>words</code>可能有不同的大小</li>
<li>通常<code>32</code>位系統使用<code>4 bytes</code>，<code>64</code>位使用<code>8 bytes words</code></li>
</ul>
<h3 id="I-O-Devices"><a href="#I-O-Devices" class="headerlink" title="I&#x2F;O Devices"></a>I&#x2F;O Devices</h3><ul>
<li>系統連接外部世界的方式，例如滑鼠鍵盤</li>
<li>通過<code>controller</code>或是<code>adapter</code>連接至<code>I/O bus</code>(<code>controller</code>是晶片組在主板上或是設備本身；而<code>adapter</code>是可插入主板插槽的<code>card</code>。他們的目的都是為了能夠在<code>bus</code>與<code>device</code>之間傳遞訊息)</li>
</ul>
<h3 id="Main-memory-主記憶體"><a href="#Main-memory-主記憶體" class="headerlink" title="Main memory (主記憶體)"></a>Main memory (主記憶體)</h3><ul>
<li>當處理器執行該程式時，存放程式執行時的臨時資料，包含程式以及其操控的數據</li>
<li>通常包含一坨<code>Dynamic random access memory (DRAM)</code>晶片</li>
<li>邏輯上，記憶體是一串<code>Bytes</code>陣列，每個陣列都有獨一無二的位址</li>
</ul>
<h3 id="處理器"><a href="#處理器" class="headerlink" title="處理器"></a>處理器</h3><ul>
<li><code>CPU</code></li>
<li><code>interprets or executes</code>在主記憶體中的指令</li>
<li>核心是<code>word-size storage device</code>(或稱<code>register</code>)，名為<code>program counter (PC)</code></li>
<li>任何時候，<code>PC</code>都指向在主記憶體中的<code>machine-language instructions</code></li>
<li>只要系統運作中，處理器永遠都在執行<code>PC</code>所指向的指令，完成後更新<code>PC</code>指向下一個指令(指令不一定是記憶體中的連續下一個指令)</li>
<li><code>register file</code>是一個小的儲存裝置，裡面包含一坨<code>word-size registers</code></li>
<li><code>ALU (Arithmetic/logic unit)</code>計算新的數據和位址</li>
<li>以下是幾個常見的<code>CPU operation</code><ul>
<li><code>Load</code>: 從主記憶體複製<code>byte</code>或是<code>word</code>到一個<code>register</code>，覆蓋該<code>register</code>先前值</li>
<li><code>Store</code>: 從<code>register</code>複製<code>byte</code>或是<code>word</code>到主記憶體的某個位置，覆蓋該位置的值</li>
<li><code>Operate</code>: 複製兩個<code>registers</code>的內容到<code>ALU</code>，對兩個<code>words</code>執行<code>arithmetic operation</code>，然後儲存結果到一個<code>register</code>，覆蓋<code>register</code>的先前值</li>
<li><code>Jump</code>: 提取出指令本身，然後複製該<code>word</code>到<code>Program counter</code>，覆蓋<code>PC</code>先前值</li>
</ul>
</li>
<li>雖然架構簡單，但是現代的處理器使用複雜許多的機制來加速程式執行時間，詳細在之後章節會討論</li>
</ul>
<h2 id="執行hello程式"><a href="#執行hello程式" class="headerlink" title="執行hello程式"></a>執行<code>hello</code>程式</h2><p>當我們在<code>shell</code>輸入<code>./hello</code>的時候，這幾個字會通過<code>controller-&gt;I/O bridge-&gt;Bus interface-&gt;register-&gt;最後再到main memory</code>，像下圖所示</p>
<p><img src="https://i.imgur.com/babLCHf.png" srcset="/img/loading.gif" lazyload alt="Reading the hello command from the keyboard"></p>
<p>當按下<code>enter</code>鍵的時候，<code>shell</code>就知道我們已經輸入完畢，接著就會自動執行<code>hello</code>這個程式，然後把其指令以及數據從硬碟複製到主記憶體，數據包含<code>hello, world\n</code>就會最終被印出來</p>
<p>期間，數據從硬碟到主記憶體是使用<code>direct memory access (DMA)</code>技術，不用經過處理器，像<code>Figure 1.6</code>所示</p>
<p><img src="https://i.imgur.com/rKgt0aw.png" srcset="/img/loading.gif" lazyload alt="Loading the executable from disk into main memory"></p>
<p>最終印出時，指令會從記憶體複製<code>hello, world\n</code>的<code>bytes</code>到<code>register file</code>最後再到<code>display device</code>，如<code>Figure 1.7</code></p>
<p><img src="https://i.imgur.com/pMAzv3D.png" srcset="/img/loading.gif" lazyload alt="Writing the output string from memory to the display"></p>
<h2 id="Cache-快取-大有用處"><a href="#Cache-快取-大有用處" class="headerlink" title="Cache (快取)大有用處"></a>Cache (快取)大有用處</h2><p>綜上所述，可以發現系統花很多時間在移動資訊，例如為了加載程式，需要把程式複製到主記憶體；為了處理器可以執行程式，指令需要從主記憶體被複製到處理器等等。以程式設計師的角度來看，這些無疑都是為”real work”增加負擔。因此，系統設計師的主要目標就是要讓這些複製的操作盡可能的變快</p>
<p>物理定律造成越大容量的設備讀寫速度越慢，但越快的設備同樣的容量價格越高昂，例如:</p>
<ul>
<li><code>disk drive</code>容量比主記憶體容量大一千倍，但處理器可能需要一千萬倍的時間去讀取<code>disk drive</code>，相對於主記憶體</li>
</ul>
<p>隨著半導體的進步，處理器與記憶體之間的速度差異逐年上升，簡單來說就是讓處理器變快比讓記憶體變快更加簡單</p>
<p>為了應對這個巨大的<code>processor-memory gap</code>，系統設計師引入了<code>cache memory</code>，又小又快，存放著處理器短期內可能會需要的資料，如<code>Figure 1.9</code>，越上層的儲存設備存取速度越快</p>
<p><img src="https://i.imgur.com/9e2CmFR.png" srcset="/img/loading.gif" lazyload alt="An example of a memory hierarchy"></p>
<p>容量大小: L1 &gt; L2 &gt; L3</p>
<ul>
<li>他們都是<code>static random access memory (SRAM)</code>技術的產物</li>
<li><code>L3</code>基本上存在於高性能電腦</li>
<li><code>locality</code>是提升性能的關鍵，如何讓最常用的資料儲存在<code>cache</code>中是核心</li>
<li><code>Figure 1.9</code>，每一層都是下一層的<code>cache</code></li>
</ul>
<h2 id="作業系統掌管硬體"><a href="#作業系統掌管硬體" class="headerlink" title="作業系統掌管硬體"></a>作業系統掌管硬體</h2><ul>
<li>回到<code>hello</code>程式，從頭到尾，其實程式都沒有直接存取滑鼠、鍵盤、主記憶體和螢幕等等的設備，全都是通過作業系統來達成溝通，如<code>Figure 1.10</code>所示，<code>OS</code>介於程式與硬體之間</li>
</ul>
<p><img src="https://i.imgur.com/3lW2nVT.png" srcset="/img/loading.gif" lazyload alt="Layered view of a computer system"></p>
<p>作業系統這樣做有兩個目的:</p>
<ol>
<li>保護硬體</li>
<li>提供應用程式一個簡單且統一的方式去操控各式各樣的硬體設備</li>
</ol>
<p>為此兩個目的，<code>OS</code>用抽象化來達成，就像<code>Figure 1.11</code></p>
<p><img src="https://i.imgur.com/hKpWFea.png" srcset="/img/loading.gif" lazyload alt="Abstractions provided by an operating system"></p>
<ul>
<li><code>Files</code>是<code>I/O devices</code>的抽象</li>
<li><code>virtual memory</code> -&gt; <code>main memory</code></li>
<li><code>processes</code> -&gt; <code>processor</code></li>
</ul>
<h3 id="Processes"><a href="#Processes" class="headerlink" title="Processes"></a>Processes</h3><p>當我們在執行<code>hello</code>這個程式的時候彷彿沒有被打斷，整個系統都在為了執行它而工作，這個就是<code>process</code>的厲害之處，因為實際上是有多個<code>processes</code>同時執行。而通常<code>processes</code>會比<code>CPU</code>還多，所以沒辦法一個<code>CPU</code>執行一個<code>process</code></p>
<ul>
<li>單<code>CPU</code>可以通過<code>context switching</code>的方式來切換<code>process</code>以達到多工處理的功能</li>
<li><code>context swtiching</code>會儲存當前<code>process</code>的<code>context</code>然後<code>restore the context of the new process</code>，像<code>Figure 1.12</code></li>
<li>接下來的幾段章節會著重討論只有單<code>CPU</code>的<code>uniprocessor system</code></li>
</ul>
<p><img src="https://i.imgur.com/oE43if2.png" srcset="/img/loading.gif" lazyload alt="Process context switching"></p>
<p>當我們在<code>shell process</code>輸入完指令按下<code>enter</code>，<code>shell</code>會呼叫系統，讓<code>OS</code>儲存<code>shell</code>的<code>context</code>，建立<code>hello process</code>還有其<code>context</code>，讓<code>hello process</code>獲得控制權，結束後再<code>restore shell context</code></p>
<p><strong>Kernel</strong>是<code>OS</code>的一部分，常駐在記憶體中，當一個程式需要<code>OS</code>的協助的時候，例如讀取和寫入檔案，會執行<code>system call</code>指令把控制權交還給<code>kernel</code>，執行完操作後再交還給原本的程式。<strong>Kernel本身不是一個process</strong>，他是一坨<code>code</code>和資料結構被系統用來管理所有的<code>processes</code></p>
<h3 id="Threads-執行緒"><a href="#Threads-執行緒" class="headerlink" title="Threads (執行緒)"></a>Threads (執行緒)</h3><ul>
<li>現代系統中一個<code>process</code>常常包含很多<code>thread</code></li>
<li>越發重要，因為網路伺服器需要併發效能</li>
<li>在<code>threads</code>之間傳遞訊息比<code>processes</code>之間簡單得多</li>
<li>通常比<code>processes</code>更有效率</li>
</ul>
<h3 id="Virtual-Memory-虛擬記憶體"><a href="#Virtual-Memory-虛擬記憶體" class="headerlink" title="Virtual Memory (虛擬記憶體)"></a>Virtual Memory (虛擬記憶體)</h3><ul>
<li>讓<code>process</code>以為自己有<code>main memory</code>的專屬使用權</li>
<li>對每個<code>process</code>來說，<code>memory</code>都長一樣，名為<code>virtual address space</code>，如<code>Figure 1.13</code>所示</li>
<li></li>
</ul>
<p><img src="https://i.imgur.com/snODUPB.png" srcset="/img/loading.gif" lazyload alt="Linux process virtual address space (The regions are not drawn to scale)"></p>
<ul>
<li>最上層是給<code>OS</code>對每個<code>process</code>的通用<code>data</code>和<code>code</code>的空間</li>
<li>往下層的都是<code>process</code>所定義的<code>code</code>和<code>data</code></li>
<li>地址由下往上遞增</li>
</ul>
<h3 id="Files"><a href="#Files" class="headerlink" title="Files"></a>Files</h3><ul>
<li>一大串<code>bytes</code>，就這樣</li>
<li>每個<code>I/O</code>設備包含硬碟、鍵盤、螢幕和網路等等都被模擬成<code>file</code>，系統中的<code>input</code>和<code>output</code>都是以寫入和讀取檔案來執行</li>
</ul>
<h2 id="用網路來和其他系統溝通"><a href="#用網路來和其他系統溝通" class="headerlink" title="用網路來和其他系統溝通"></a>用網路來和其他系統溝通</h2><ul>
<li>網路可以被視為另一個<code>I/O</code>設備</li>
</ul>
<p><img src="https://i.imgur.com/oH67rXi.png" srcset="/img/loading.gif" lazyload alt="A network is another I/O device"></p>
<p><img src="https://i.imgur.com/kGRdWIT.png" srcset="/img/loading.gif" lazyload alt="Using telnet to run `hello` remotely over a network"></p>
<h2 id="本章結語和重點概念"><a href="#本章結語和重點概念" class="headerlink" title="本章結語和重點概念"></a>本章結語和重點概念</h2><h3 id="Amdahl’s-Law"><a href="#Amdahl’s-Law" class="headerlink" title="Amdahl’s Law"></a>Amdahl’s Law</h3><ul>
<li><code>Gene Amdahl</code></li>
<li>代表處理器並行運算之後效率提升的能力</li>
<li>要顯著提升系統的效率，就一定要提升整個系統絕大部分的執行速度</li>
</ul>
<hr>
<ul>
<li>$T_{old}和T_{new}$代表舊與新的時間</li>
<li>$\alpha$是占總時間的比例</li>
<li>$k$是提升多少係數</li>
</ul>
<p>$T_{new} &#x3D; (1 - \alpha)T_{old} + (\alpha T_{old}) &#x2F; k &#x3D; T_{old}[(1 - \alpha) + \alpha &#x2F; k]$</p>
<p>可以得到加速$S &#x3D; T_{old} &#x2F; T_{new}$</p>
<p>Ex.</p>
<p>假設一個任務佔了某系統60%的時間($\alpha &#x3D; 0.6$)，加快了係數3($k &#x3D; 3$)，那套用公式就可以得到$S &#x3D; 1 &#x2F; {(1 - 0.6) + 0.6 &#x2F; 3}$，$S &#x3D; 1.67$，速度約提升<code>1.67</code>倍</p>
<p>即便提升<code>60%</code>系統部分的時間，加快的效果也不顯著，所以為了顯著提升，越大部分能提升越好，最好是整個系統都能提升係數<code>k</code>。上述例子如果改成整個系統提升<code>k</code>係數的話那可以直接提升<code>5</code>倍速度</p>
<h3 id="Concurrency-and-Parallelism-並行性與平行性"><a href="#Concurrency-and-Parallelism-並行性與平行性" class="headerlink" title="Concurrency and Parallelism (並行性與平行性)"></a>Concurrency and Parallelism (並行性與平行性)</h3><ul>
<li><code>Concurrency</code>: 一個系統有多個同時執行的活動</li>
<li><code>Parallelism</code>: 用<code>Concurrency</code>來讓系統執行更快</li>
</ul>
<p><code>Parallelism</code>可以用不同程度的<code>abstraction</code>來包裝</p>
<h4 id="Thread-Level-Concurrency"><a href="#Thread-Level-Concurrency" class="headerlink" title="Thread-Level Concurrency"></a>Thread-Level Concurrency</h4><ul>
<li><code>uniprocessor system</code>通過快速切換任務來達成<code>concurrency</code></li>
<li><code>multiprocessor system</code>同時使用多個處理器來並行，通常使用<code>multi-core processors</code>和<code>hyperthreading</code></li>
</ul>
<p><img src="https://i.imgur.com/p7OSF2D.png" srcset="/img/loading.gif" lazyload alt="Categorizing different processor configurations"></p>
<p><img src="https://i.imgur.com/NFpERa3.png" srcset="/img/loading.gif" lazyload alt="Multi-core processor organization"></p>
<ul>
<li>多核之間共享高階<code>cache</code>以及<code>main memory</code></li>
<li><code>Hyperthreading</code>(超執行緒)有時稱作<code>simultaneous multi-threading</code>，允許單個<code>CPU</code>執行多個控制流，簡單來說就是一個核心多個<code>thread</code>，例如<code>Intel Core i7</code>每個核心都有兩個<code>threads</code>，所以四核心就會有八個<code>threads</code></li>
</ul>
<h4 id="Instruction-Level-Parallelism"><a href="#Instruction-Level-Parallelism" class="headerlink" title="Instruction-Level Parallelism"></a>Instruction-Level Parallelism</h4><ul>
<li>在更底層的<code>abstraction</code></li>
<li>現代處理器可以一次執行多個命令，一個<code>clock cycle</code>可以執行<code>2~4</code>個指令，雖然需要比較多的<code>cycles</code>(20)，但可以執行更多命令；以前(1978)一次只能執行一條命令，且需要多個<code>clock cycles</code>(3~10)</li>
<li><code>pipelining</code>把指令切開成多個步驟，以達到並行的目的</li>
<li><code>superscalar</code>(超純量)CPU架構可以讓一顆核心執行指令級並行的運算</li>
</ul>
<h4 id="Single-Instruction-Multiple-Data-SIMD-Parallelism"><a href="#Single-Instruction-Multiple-Data-SIMD-Parallelism" class="headerlink" title="Single-Instruction, Multiple-Data (SIMD) Parallelism"></a>Single-Instruction, Multiple-Data (SIMD) Parallelism</h4><ul>
<li>在最底層，現代處理器有特殊的硬體讓單一個指令可以變成多個動作，藉此並行運算，這種模式就稱為<code>SIMD parallelism</code></li>
</ul>
<h2 id="Abstraction是CS最重要的概念之一"><a href="#Abstraction是CS最重要的概念之一" class="headerlink" title="Abstraction是CS最重要的概念之一"></a>Abstraction是CS最重要的概念之一</h2><ul>
<li>有了<code>abstraction</code>可以讓程式統一，進而讓不同硬體也能執行同一個程式，也能讓程式設計師在寫程式的時候不用把每個層級實際要做的事情都寫下來</li>
</ul>
<p><img src="https://i.imgur.com/AccvZwZ.png" srcset="/img/loading.gif" lazyload alt="Some abstractions provided by a computer system"></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E9%9B%BB%E8%85%A6%E7%A7%91%E5%AD%B8/" class="category-chain-item">電腦科學</a>
  
  
    <span>></span>
    
  <a href="/categories/%E9%9B%BB%E8%85%A6%E7%A7%91%E5%AD%B8/Computer-Systems-A-Programmer-s-Perspective/" class="category-chain-item">Computer Systems - A Programmer&#39;s Perspective</a>
  
  

  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Computer-System/" class="print-no-link">#Computer System</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>CS:APP 電腦系統:程式設計師的角度 第一章筆記</div>
      <div>https://f88083.github.io/2024/02/14/CS-APP-電腦系統-程式設計師的角度-第一章筆記/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Simon Lai</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>發布於</div>
          <div>2024年2月14日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>許可協議</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="NC - 非商業性使用">
                    <i class="iconfont icon-nc"></i>
                  </span>
                </a>
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="SA - 相同方式共享">
                    <i class="iconfont icon-sa"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/02/16/1584-Min-Cost-to-Connect-All-Points-Medium/" title="1584. Min Cost to Connect All Points - Medium">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">1584. Min Cost to Connect All Points - Medium</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/02/14/130-Surrounded-Regions-Medium/" title="130. Surrounded Regions - Medium">
                        <span class="hidden-mobile">130. Surrounded Regions - Medium</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
    <div id="giscus" class="giscus"></div>
    <script type="text/javascript">
      Fluid.utils.loadComments('#giscus', function() {
        var options = {"repo":"f88083/blog-comments","repo-id":"R_kgDOKvLNrw","category":"Announcements","category-id":"DIC_kwDOKvLNr84CbPZE","theme-light":"light","theme-dark":"dark","mapping":"pathname","reactions-enabled":1,"emit-metadata":0,"input-position":"top","lang":"zh-TW"};
        var attributes = {};
        for (let option in options) {
          if (!option.startsWith('theme-')) {
            var key = option.startsWith('data-') ? option : 'data-' + option;
            attributes[key] = options[option];
          }
        }
        var light = 'light';
        var dark = 'dark';
        window.GiscusThemeLight = light;
        window.GiscusThemeDark = dark;
        attributes['data-theme'] = document.documentElement.getAttribute('data-user-color-scheme') === 'dark' ? dark : light;
        for (let attribute in attributes) {
          var value = attributes[attribute];
          if (value === undefined || value === null || value === '') {
            delete attributes[attribute];
          }
        }
        var s = document.createElement('script');
        s.setAttribute('src', 'https://giscus.app/client.js');
        s.setAttribute('crossorigin', 'anonymous');
        for (let attribute in attributes) {
          s.setAttribute(attribute, attributes[attribute]);
        }
        var ss = document.getElementsByTagName('script');
        var e = ss.length > 0 ? ss[ss.length - 1] : document.head || document.documentElement;
        e.parentNode.insertBefore(s, e.nextSibling);
      });
    </script>
    <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目錄</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  









    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜尋</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">關鍵字</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script  src="https://lib.baomitu.com/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js" ></script>

  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允許 JavaScript 運行的環境下瀏覽效果更佳</div>
  </noscript>
</body>
</html>
